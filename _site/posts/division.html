<!DOCTYPE HTML>
<html lang="en">
  <head>
    <title>Approximate Polynomial Division</title>
        <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content>
    <meta name="author" content>
    <link href="../css/bootstrap.css" rel="stylesheet">
    <link href="../css/syntax.css" rel="stylesheet">

    <script type="text/x-mathjax-config">
        MathJax.Hub.Config({
            TeX: { equationNumbers: { autoNumber: "AMS" } }
        });
    </script>
    <script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

    <link href="http://fonts.googleapis.com/css?family=Open+Sans" rel="stylesheet" type="text/css">

	<script>
	  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
	  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
	  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
	
	  ga('create', 'UA-50420538-1', 'github.com');
	  ga('send', 'pageview');
	</script>
    <link href="../css/aern.css" rel="stylesheet">
    <link href="../img/logo-26.ico" rel="shortcut icon" />
  </head>
  <body>
    <div class="navbar-wrapper">
  <div class="container">
    <div class="navbar navbar-inverse navbar-static-top" role="navigation">
      <div class="container">
        <div class="navbar-header">
<!--           <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse"> -->
<!--             <span class="sr-only">Toggle navigation</span> -->
<!--             <span class="icon-bar"></span> -->
<!--             <span class="icon-bar"></span> -->
<!--             <span class="icon-bar"></span> -->
<!--           </button> -->
          <a class="navbar-brand" href="../index.html">
            <img src="../img/logo-113.png" width="30" height="30" />
          </a>
        </div>
        <div class="navbar-collapse collapse">
          <ul class="nav navbar-nav">
            <li><a href="../index.html">Home</a></li>
<!--             <li class="dropdown"> -->
<!--               <a href="#" class="dropdown-toggle" data-toggle="dropdown">Products <b class="caret"></b></a> -->
<!--               <ul class="dropdown-menu"> -->
<!--                 <li><a href="#">Warp Drive</a></li> -->
<!--                 <li><a href="#">Fusion Reactor</a></li> -->
<!--                 <li><a href="#">Sufficiently Smart Compiler</a></li> -->
<!--                 <li class="divider"></li> -->
<!--                 <li class="dropdown-header">Services</li> -->
<!--                 <li><a href="#">Enlightenment</a></li> -->
<!--               </ul> -->
<!--             </li> -->
<!--             <li><a href="/pages/features.html">Features</a></li> -->
<!--             <li><a href="/tutorials.html">Tutorials</a></li> -->
            <li><a href="../news.html">News</a></li>
            <li><a href="https://github.com/michalkonecny/aern">on GitHub</a></li>
          </ul>
        </div>
      </div>
    </div>
  </div>
</div>


    <div class="container">
      <h2>Approximate Polynomial Division</h2>
      <i>(posted on April 27, 2014)</i>
      <hr class="divider" />
      
      <h3 id="the-goal">The goal</h3>
<p>The goal is to find a polynomial approximation of the reciprocal <span class="math">\[
\frac{1}{f(x_1,x_2,\ldots)}
\]</span> where each variable <span class="math">\(x_i\)</span> ranges over some compact real interval <span class="math">\(D_i\)</span> and the range of <span class="math">\(f\)</span> over these domains is within the interval <span class="math">\([b,c]\)</span> where <span class="math">\(b &gt; 0\)</span>.</p>
<h3 id="reduction-to-a-unary-problem">Reduction to a unary problem</h3>
<p>To simplify the task, we split it into two sub-tasks.</p>
<p>The first sub-task is to approximate the unary reciprocal <span class="math">\[
y(x) = \frac{1}{x+d}
\]</span> where <span class="math">\(x\in[-1,1]\)</span> and <span class="math">\(d&gt;1\)</span> will be specified later.</p>
<p>We can get an approximation of the original reciprocal using an approximation of <span class="math">\(y\)</span> as follows: <span class="math">\[
\begin{equation}\label{eq:using-y}
\frac{1}{f(x_1,x_2,\ldots)} 
= 
y\left(\frac{2}{c-b}f(x_1,x_2,\ldots)-d\right)\frac{2}{c-b}
\end{equation}
\]</span> where we used the substitution: <span class="math">\[
\begin{equation}\label{eq:x}
x = \frac{2}{c-b}f(x_1,x_2,\ldots)-d
\end{equation}
\]</span> The scaling and shifting of <span class="math">\(f\)</span> in <span class="math">\(\eqref{eq:x}\)</span> should ensure that <span class="math">\(x\)</span> falls within <span class="math">\([-1,1]\)</span>. To make it so, we set <span class="math">\(d=1+\frac{2b}{c-b}\)</span>.</p>
<h3 id="the-tau-method">The tau method</h3>
<p>In order to approximate <span class="math">\(y(x)\)</span>, we follow the tau method as described, for example, in <a href="http://books.google.co.uk/books/about/Chebyshev_Polynomials.html?id=8FHf0P3to0UC&amp;redir_esc=y">Mason &amp; Handscob (2002)</a> on page 62. The approximation of <span class="math">\(y(x)\)</span> is a polynomial <span class="math">\(p(x)\)</span> with the following property: <span class="math">\[
\begin{equation}\label{eq:tau}
p(x)\cdot (x+d) = 1 + \tau \cdot T_{k+1}(x)
\end{equation}
\]</span> where <span class="math">\(T_i\)</span> is the Chebyshev polynomial of order <span class="math">\(i\)</span>. We will soon show that there is a unique polynomial <span class="math">\(p(x)\)</span> and unique <span class="math">\(\tau\)</span> that satisfy the above equality. It is clear that this polynomial has to have order at most <span class="math">\(k\)</span>.</p>
<h4 id="estimating-the-error">Estimating the error</h4>
<p>Before discussing how to compute <span class="math">\(p(x)\)</span> and <span class="math">\(\tau\)</span> that satisfy <span class="math">\(\eqref{eq:tau}\)</span>, let us analyse the difference between <span class="math">\(p(x)\)</span> and <span class="math">\(y(x)\)</span> and the resulting error of the approximate reciprocal obtained using <span class="math">\(p(x)\)</span> in place of <span class="math">\(y(x)\)</span>. <span class="math">\[
\begin{equation}\label{eq:error}
|p(x) - y(x)|
=
\left|T_{k+1}(x) \frac{\tau}{x+d}\right| 
\leq 
\left|\frac{\tau}{x+d}\right| 
=
\frac{|\tau|}{x+d}
\leq
\frac{|\tau|}{d-1}
=
\frac{|\tau|(c-b)}{2b}
\end{equation}
\]</span></p>
<p>Not surprisingly, for <span class="math">\(b\)</span> close to <span class="math">\(0\)</span>, the error could be very large. Nevertheless, if <span class="math">\(\tau\)</span> converges to <span class="math">\(0\)</span> with increasing <span class="math">\(k\)</span>, the error can be minimised arbitrarily.</p>
<h4 id="computing-px">Computing p(x)</h4>
<p>Both sides of equation <span class="math">\(\eqref{eq:tau}\)</span> are polynomials. Thus the coefficients of the polynomials must be equal. We focus on coefficients of these polynomials in the <a href="http://en.wikipedia.org/wiki/Chebyshev_polynomials">Chebyshev basis</a>. Let us denote the (unknown) coefficients of <span class="math">\(p(x)\)</span> as follows: <span class="math">\[
\begin{equation}\label{eq:px}
p(x) = c_0 + c_1T_1(x) + \ldots + c_k T_k(x)
\end{equation}
\]</span></p>
<p>By elementary properties of Chebyshev polynomials it holds: <span class="math">\[
T_i(x)\cdot(x+d) = d\cdot T_i(x) + \frac{T_{|i-1|}(x) + T_{i+1}(x)}{2}
\]</span> which leads to: <span class="math">\[
\begin{array}{rcl}
p(x)\cdot(x+d) 
&amp; = &amp; c_0 \cdot\left(  d\cdot T_0(x) + T_1(x) \right)
\\
&amp; + &amp; c_1 \cdot\left( T_0(x)/2 + d\cdot T_1(x) + T_2(x)/2 \right)
\\
&amp; \ldots &amp;
\\ 
&amp; + &amp; c_{k-1} \cdot\left( T_{k-2}(x)/2 + d\cdot T_{k-1}(x) + T_k(x)/2 \right)
\\ 
&amp; + &amp; c_k \cdot\left( T_{k-1}(x)/2 + d\cdot T_k(x) + T_{k+1}(x)/2 \right)
\\ 
\end{array}
\]</span></p>
<p>Now by grouping the terms that contain Chebyshev polynomials <span class="math">\(T_i\)</span> on both sides of equation <span class="math">\(\eqref{eq:tau}\)</span>, we get: <span class="math">\[
\begin{array}{rrcl}
T_{k+1}(x): &amp; \tau &amp; = &amp; c_k / 2
\\
T_{k}(x): &amp; 0 &amp; = &amp; d\cdot c_k + c_{k-1}/2
\\
T_{k-1}(x): &amp; 0 &amp; = &amp; c_{k}/2 + d\cdot c_{k-1} + c_{k-2}/2
\\
&amp; &amp; \ldots
\\[1ex]
T_{2}(x): &amp; 0 &amp; = &amp; c_{3}/2 + d\cdot c_{2} + c_{1}/2
\\
T_{1}(x): &amp; 0 &amp; = &amp; c_{2}/2 + d\cdot c_{1} + c_{0}
\\
T_{0}(x): &amp; 1 &amp; = &amp; c_{1}/2 + d\cdot c_{0}
\\
\end{array}
\]</span></p>
<p>We have <span class="math">\(k+2\)</span> linear equations with <span class="math">\(k+2\)</span> unknowns <span class="math">\(c_0,\ldots,c_k,\tau\)</span>. Moreover, by a simple transformation we get formulas for the individual coefficients:</p>
<p><span class="math">\[
\begin{equation}\label{eq:coeffs-tau}
\begin{array}{rcl}
c_k &amp; = &amp; 2\tau
\\
c_{k-1} &amp; = &amp; -2dc_k
\\
c_{k-2} &amp; = &amp; -2dc_{k-1}-c_k
\\
&amp; \dots &amp;
\\
c_1 &amp; = &amp; -2dc_2 - c_3
\\
c_0 &amp; = &amp; -dc_1 - c_2/2
\\
1 &amp; = &amp; dc_0 + c_1/2 
\end{array}
\end{equation}
\]</span> This system is solved in linear time as follows: Proceeding by substitutions from top to bottom in the above list we obtain a formula for each coefficient, featuring only <span class="math">\(\tau\)</span>, and, finally, we determine the value of <span class="math">\(\tau\)</span> from the last equation.</p>

      <hr class="divider" />
      <footer>
  <p class="pull-right"><a href="#">Back to top</a></p>
  <p>
<!--     &copy; 2009-2014 Michal Konečný -->
<!--     &middot;  -->
<!--     <a href="/pages/privacy.html">Privacy</a>  -->
<!--     &middot;  -->
<!--     <a href="/pages/tos.html">Terms</a></p> -->
</footer>

    </div>

    </div><!-- /.container -->
    <script src="../js/jquery.js"></script>
    <script src="../js/bootstrap.js"></script>
    <script src="../js/holder.js"></script>
  </body>
</html>
